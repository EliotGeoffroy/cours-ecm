<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<title>Architecture de l&#8217;application</title>
<link rel="stylesheet" href="./../../style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./coderay-asciidoctor.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_architecture_de_lapplication">Architecture de l&#8217;application</a>
<ul class="sectlevel1">
<li><a href="#_vision_globale">1. Vision globale</a></li>
<li><a href="#_technology_stack">2. Technology stack</a></li>
<li><a href="#_structure_de_projet_standard">3. Structure de projet standard</a></li>
<li><a href="#_structure_logicielle_de_lapp">4. Structure logicielle de l&#8217;app</a></li>
<li><a href="#_vue_séquentielle">5. Vue séquentielle</a></li>
<li><a href="#_tests_et_tdd">6. Tests et TDD</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="paragraph">
<p><a href="../../index.html">&lt;&lt; Retour à l&#8217;index</a></p>
</div>
<h1 id="_architecture_de_lapplication" class="sect0">Architecture de l&#8217;application</h1>
<div class="sect1">
<h2 id="_vision_globale">1. Vision globale</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;architecture est composée d&#8217;une application web qui est reliée à une base de données mongodb.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/-------\      +-------+
|       |      |{s}    |
|web app| ---&gt; | mongo |
|       |      |       |
\-------/      +-------+</pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;application est en java et est packagée sous le format standard <strong>war</strong>.</p>
</div>
<div class="paragraph">
<p>Mongodb est une base NOSQL qui stocke des documents en format BSON (Binary JSON).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_technology_stack">2. Technology stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Voici la liste des principales technologies utilisées dans notre projet.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="java.png" alt="java" width="100">
</div>
</div>
<div class="paragraph">
<p>Java est un language de programmation orienté objet.</p>
</div>
<div class="paragraph">
<p>Java, c&#8217;est aussi la jvm qui permet de faire tourner les programmes et le jdk qui contient la librairie standard et le compilateur.</p>
</div>
<div class="paragraph">
<p>Java Enterprise Edition (JEE) est un ensemble de librairies supplémentaires et outils pour le développement d&#8217;applications.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="gradle.png" alt="gradle" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="https://gradle.org/" target="_blank" rel="noopener">Gradle</a> est un outils de build pour beaucoup de languages (java, groovy, scala, c&#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>Il se configure à l&#8217;aide d&#8217;un language spécifique (DSL) en groovy</p>
</div>
<div class="paragraph">
<p>Il est plus récent et plus souple que son concurent principal : maven</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="Tomcat.png" alt="Tomcat" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="http://tomcat.apache.org/" target="_blank" rel="noopener">Tomcat</a> est un serveur web pouvant lancer des applications web java.</p>
</div>
<div class="paragraph">
<p>Il est open source et offre de très bonnes performances.</p>
</div>
<div class="paragraph">
<p>C&#8217;est celui que l&#8217;on va utiliser pour le développement.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="spring.png" alt="spring" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="http://projects.spring.io/spring-framework/" target="_blank" rel="noopener">Spring</a> est un framework par injection de dépendances (DI).</p>
</div>
<div class="paragraph">
<p>Spring a aussi un module MVC pour le web, que nous utilisons.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="mongo.jpg" alt="mongo" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="https://www.mongodb.org/" target="_blank" rel="noopener">MongoDB</a> est une base données NOSQL orientée document.</p>
</div>
<div class="paragraph">
<p>Un document est un arbre json qui est stocké en Binary JSON (BSON).</p>
</div>
<div class="paragraph">
<p>Ce sont des structures souples, sans schéma.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="bootstrap.png" alt="bootstrap" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="https://getbootstrap.com/" target="_blank" rel="noopener">Bootstrap</a> est un framework html, css et javascript pour développer des pages responsives.</p>
</div>
<div class="paragraph">
<p>Développé initialement en interne chez twitter, il est aujourd&#8217;hui très largement utilisé.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="openblock float-group">
<div class="content">
<div class="imageblock left">
<div class="content">
<img src="jquery.png" alt="jquery" width="100">
</div>
</div>
<div class="paragraph">
<p><a href="http://jquery.com/" target="_blank" rel="noopener">jquery</a> est un framework javascript très populaire.</p>
</div>
<div class="paragraph">
<p>Il est simple mais néanmoins très puissant.</p>
</div>
<div class="paragraph">
<p>Il est utilisé par certaines fonctionnalités de bootstrap.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_structure_de_projet_standard">3. Structure de projet standard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Maven a introduit le <a href="https://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html" target="_blank" rel="noopener">Standard Directory Layout</a> : c&#8217;est une façon standard d&#8217;organiser ses sources.</p>
</div>
<div class="paragraph">
<p>Gradle suit ce standard :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>src <i class="conum" data-value="1"></i><b>(1)</b>
├─ main <i class="conum" data-value="2"></i><b>(2)</b>
|  ├─ [language 1] <i class="conum" data-value="3"></i><b>(3)</b>
|  ├─ [language 2]
└─ test <i class="conum" data-value="4"></i><b>(4)</b>
   ├─ [language 1]
   ├─ [language 2]</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>toutes les sources</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>le code de l&#8217;application</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>le code est segmenté par language</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>le code des test</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<strong>Convention over configuration</strong> : cette arborescence est une convention, si on la suit, il n&#8217;y a pas besoin de configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Dans notre cas, pour une <strong>application web</strong> JEE :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>src
├─ main
|  ├─ java <i class="conum" data-value="1"></i><b>(1)</b>
|  ├─ resources <i class="conum" data-value="2"></i><b>(2)</b>
|  └─ webapp <i class="conum" data-value="3"></i><b>(3)</b>
|     ├─ WEB-INF <i class="conum" data-value="4"></i><b>(4)</b>
|     └─ META-INF <i class="conum" data-value="5"></i><b>(5)</b>
└─ test
   ├─ java
   └─ resources</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>notre code en java</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>les fichiers qui vont aussi dans le classpath</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>les fichiers qui vont à la racine de l&#8217;application web</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>fichiers de configuration protégés</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>fichiers de méta données protégés</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Cette distribution est pratique pour le développement.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Au build, gradle va compiler les classes java et produire le war.</p>
</div>
<div class="paragraph">
<p>La structure à l&#8217;intérieur du war suit un standard qui est compris par les conteneurs de servlets tels que tomcat.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="gradle-build.jpg" alt="gradle build">
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_structure_logicielle_de_lapp">4. Structure logicielle de l&#8217;app</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;application a une structure traditionnelle MVC pour le web.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>                                                                                 +----------+
                              +-------------------+     +------------------+     |{s}       |
                              |                   |     |                  |     |          |
                        +----&gt;+    Controllers    +----&gt;+     Services     +----&gt;+          |
                        |     |                   |     |                  |     |   Base   |
+------------------+    |     +-------------------+     +------------------+     |          |
|                  |    |                                                        |          |
|     request      +----+                                                        +----------+
|    dispatcher    |    |
|                  |    |     +-------------------+
+------------------+    |     |                   |
                        +----&gt;+     JSP views     |
                              |                   |
                              +-------------------+</pre>
</div>
</div>
<div class="paragraph">
<p>Le rôle des composants :</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>request dispatcher</strong> : il est fournit par le framework. Il 'dispatch' les requêtes entrantes vers les bons controllers / vues.</p>
</li>
<li>
<p><strong>controllers</strong> : ils recoivent la requête, utilisent les services et préparent les données.</p>
</li>
<li>
<p><strong>services</strong> : on y range la logique métier.</p>
</li>
<li>
<p><strong>JSP views</strong> : ce sont les templates qui produisent le html.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Cette division permet d&#8217;utiliser la technologie la plus adaptée pour chaque tâche.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vue_séquentielle">5. Vue séquentielle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En pratique chaque composant est appelé dans un ordre bien précis afin de remplir son role.</p>
</div>
<div class="paragraph">
<p>Voici la vision complète</p>
</div>
<div class="imageblock">
<div class="content">
<img src="mvc.png" alt="mvc" width="100%">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>La DispatcherServlet reçoit la requête.</p>
</li>
<li>
<p>La DispatcherServlet demande au HandlerMapping de choisir la bonne méthode (handler) sur le bon Controller.</p>
</li>
<li>
<p>La DispatcherServlet demande à un HandlerAdapter d&#8217;appeler le Controller.</p>
</li>
<li>
<p>Le HandlerAdapter appelle le Controller.</p>
</li>
<li>
<p>Le Controller fait son travail avec l&#8217;aide des services et retourne le modèle de données et une référence à la vue qui doit s&#8217;exécuter.</p>
</li>
<li>
<p>La DispatcherServlet demande au ViewResolver de résoudre la référence vers la View.</p>
</li>
<li>
<p>La DispatcherServlet exécute la View.</p>
</li>
<li>
<p>La View crée le rendu final de la page.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>source sur <a href="http://terasolunaorg.github.io/guideline/1.0.1.RELEASE/en/Overview/SpringMVCOverview.html">http://terasolunaorg.github.io</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Certaines étapes de ce cheminement sont optionnelles.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tests_et_tdd">6. Tests et TDD</h2>
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;application peut disposer de plusieurs types de tests</p>
</div>
<div class="ulist">
<ul>
<li>
<p>tests unitaires : test d&#8217;un composant isolé</p>
</li>
<li>
<p>tests d&#8217;intégration : test mettant en jeu plusieurs composant et potentiellement la base de données</p>
</li>
<li>
<p>tests d&#8217;interface : simulation au travers d&#8217;un navigateur</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ces tests couvrent les points importants de l&#8217;application et nous assurent un meilleur niveau de qualité.</p>
</div>
<div class="paragraph">
<p>Malheureusement, dans le projet actuel, la couverture de test est très insuffisante.</p>
</div>
<div class="paragraph">
<p><a href="../../index.html">&lt;&lt; Retour à l&#8217;index</a></p>
</div>
</div>
</div>
</div>
</body>
</html>